{"version":3,"sources":["pages/user-center/Edit.jsx"],"names":["Edit","config","title","props","match","params","id","path","ajax","state","loading","data","isEdit","fetchData","setState","get","then","res","finally","handleSubmit","values","successTip","ajaxMethod","put","post","onOk","this","formProps","labelWidth","width","ref","form","onFinish","initialValues","type","name","label","required","maxLength","layout","htmlType","onClick","resetFields","Component"],"mappings":"iRAWqBA,EALpBC,YAAO,CACJC,MAAO,SAAAC,GAAK,MAA8B,QAA1BA,EAAMC,MAAMC,OAAOC,GAAe,eAAO,gBACzDC,KAAM,0BACNC,MAAM,G,+MAGNC,MAAQ,CACJC,SAAS,EACTC,KAAM,GACNC,QAAQ,G,EAcZC,UAAY,WACR,IAAI,EAAKJ,MAAMC,QAAf,CADc,IAGPJ,EAAM,EAAKH,MAAXG,GAEP,EAAKQ,SAAS,CAACJ,SAAS,IACxB,EAAKP,MAAMK,KAAKO,IAAhB,uBAAoCT,IAC/BU,MAAK,SAAAC,GACF,EAAKH,SAAS,CAACH,KAAMM,GAAO,QAE/BC,SAAQ,kBAAM,EAAKJ,SAAS,CAACJ,SAAS,S,EAG/CS,aAAe,SAACC,GACZ,IAAI,EAAKX,MAAMC,QAAf,CADuB,IAGhBE,EAAU,EAAKT,MAAfS,OACDS,EAAaT,EAAS,iCAAU,iCAChCU,EAAaV,EAAS,EAAKT,MAAMK,KAAKe,IAAM,EAAKpB,MAAMK,KAAKgB,KAGlE,EAAKV,SAAS,CAACJ,SAAS,IACxBY,EAHyB,eAGLF,EAAQ,CAACC,eACxBL,MAAK,WAAO,IACFS,EAAQ,EAAKtB,MAAbsB,KACPA,GAAQA,OAEXP,SAAQ,kBAAM,EAAKJ,SAAS,CAACJ,SAAS,S,kEAtC1B,IAEXE,EAAgB,QADTc,KAAKvB,MAAMC,MAAMC,OAAvBC,GAGPoB,KAAKZ,SAAS,CAACF,WAEXA,GACAc,KAAKb,c,+BAkCH,IAAD,SAC2Ba,KAAKjB,MAA9BC,EADF,EACEA,QAASC,EADX,EACWA,KAAMC,EADjB,EACiBA,OAChBe,EAAY,CACdC,WAAY,IACZC,MAAO,OAGX,OACI,kBAAC,IAAD,CAAanB,QAASA,GAClB,uBACIoB,IAAK,SAAAC,GAAI,OAAI,EAAKA,KAAOA,GACzBC,SAAUN,KAAKP,aACfc,cAAetB,GAEdC,EAAS,kBAAC,IAAD,iBAAiBe,EAAjB,CAA4BO,KAAK,SAASC,KAAK,QAAS,KAClE,kBAAC,IAAD,KACI,kBAAC,IAAD,iBACQR,EADR,CAEIS,MAAM,UACND,KAAK,UACLE,UAAQ,EACRC,UAAW,OAEf,kBAAC,IAAD,iBACQX,EADR,CAEIO,KAAK,WACLE,MAAM,eACND,KAAK,WACLE,UAAQ,EACRC,UAAW,OAEf,kBAAC,IAAD,iBACQX,EADR,CAEIS,MAAM,qBACND,KAAK,OACLG,UAAW,MAEf,kBAAC,IAAD,iBACQX,EADR,CAEIO,KAAK,SACLE,MAAM,eACND,KAAK,SACLG,UAAW,MAEf,kBAAC,IAAD,iBACQX,EADR,CAEIO,KAAK,QACLE,MAAM,eACND,KAAK,QACLE,UAAQ,EACRC,UAAW,MAEf,kBAAC,IAAD,iBACQX,EADR,CAEIO,KAAK,SACLE,MAAM,2BACND,KAAK,cAGb,kBAAC,IAAD,KACI,kBAAC,IAAD,iBAAiBR,EAAjB,CAA4BY,QAAM,EAACH,MAAM,MACrC,uBAAQF,KAAK,UAAUM,SAAS,UAAhC,gBACA,uBAAQC,QAAS,kBAAM,EAAKV,KAAKW,gBAAjC,wB,GA9GMC,e","file":"static/js/12.67fa877e.chunk.js","sourcesContent":["import React, {Component} from 'react';\nimport {Form, Button} from 'antd';\nimport {FormElement, FormRow} from 'src/library/components';\nimport config from 'src/commons/config-hoc';\nimport PageContent from 'src/layouts/page-content';\n\n@config({\n    title: props => props.match.params.id === ':id' ? '添加' : '修改',\n    path: '/user-center/_/edit/:id',\n    ajax: true,\n})\nexport default class Edit extends Component {\n    state = {\n        loading: false, // 页面加载loading\n        data: {},       // 表单回显数据\n        isEdit: false,  // 是否是编辑页面\n    };\n\n    componentDidMount() {\n        const {id} = this.props.match.params;\n        const isEdit = id !== ':id';\n\n        this.setState({isEdit});\n\n        if (isEdit) {\n            this.fetchData();\n        }\n    }\n\n    fetchData = () => {\n        if (this.state.loading) return;\n\n        const {id} = this.props;\n\n        this.setState({loading: true});\n        this.props.ajax.get(`/user-center/${id}`)\n            .then(res => {\n                this.setState({data: res || {}});\n            })\n            .finally(() => this.setState({loading: false}));\n    };\n\n    handleSubmit = (values) => {\n        if (this.state.loading) return;\n\n        const {isEdit} = this.props;\n        const successTip = isEdit ? '修改成功！' : '添加成功！';\n        const ajaxMethod = isEdit ? this.props.ajax.put : this.props.ajax.post;\n        const ajaxUrl = isEdit ? '/user-center' : '/user-center';\n\n        this.setState({loading: true});\n        ajaxMethod(ajaxUrl, values, {successTip})\n            .then(() => {\n                const {onOk} = this.props;\n                onOk && onOk();\n            })\n            .finally(() => this.setState({loading: false}));\n    };\n\n    render() {\n        const {loading, data, isEdit} = this.state;\n        const formProps = {\n            labelWidth: 100,\n            width: '50%',\n        };\n\n        return (\n            <PageContent loading={loading}>\n                <Form\n                    ref={form => this.form = form}\n                    onFinish={this.handleSubmit}\n                    initialValues={data}\n                >\n                    {isEdit ? <FormElement {...formProps} type=\"hidden\" name=\"id\"/> : null}\n                    <FormRow>\n                        <FormElement\n                            {...formProps}\n                            label=\"account\"\n                            name=\"account\"\n                            required\n                            maxLength={255}\n                        />\n                        <FormElement\n                            {...formProps}\n                            type=\"password\"\n                            label=\"密码\"\n                            name=\"password\"\n                            required\n                            maxLength={255}\n                        />\n                        <FormElement\n                            {...formProps}\n                            label=\"用户名\"\n                            name=\"name\"\n                            maxLength={20}\n                        />\n                        <FormElement\n                            {...formProps}\n                            type=\"mobile\"\n                            label=\"手机\"\n                            name=\"mobile\"\n                            maxLength={20}\n                        />\n                        <FormElement\n                            {...formProps}\n                            type=\"email\"\n                            label=\"邮箱\"\n                            name=\"email\"\n                            required\n                            maxLength={50}\n                        />\n                        <FormElement\n                            {...formProps}\n                            type=\"switch\"\n                            label=\"是否启用\"\n                            name=\"enabled\"\n                        />\n                    </FormRow>\n                    <FormRow>\n                        <FormElement {...formProps} layout label=\" \">\n                            <Button type=\"primary\" htmlType=\"submit\">保存</Button>\n                            <Button onClick={() => this.form.resetFields()}>重置</Button>\n                        </FormElement>\n                    </FormRow>\n                </Form>\n            </PageContent>\n        );\n    }\n}\n"],"sourceRoot":""}